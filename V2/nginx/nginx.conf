server {
    listen 80;

    # MCP-Atlassian (Confluence Tools)
    location /atlassian/mcp {
        rewrite ^/atlassian/mcp(.*)$ /mcp$1 break;
        proxy_pass http://mcp:8000;
        proxy_http_version 1.1;
        proxy_set_header Host $host;
        proxy_set_header Connection '';
        proxy_buffering off;
        proxy_cache off;
        chunked_transfer_encoding off;
    }

    # MCP-Mermaid (Diagram Rendering + Upload)
    location /mermaid/mcp {
        rewrite ^/mermaid/mcp(.*)$ /mcp$1 break;
        proxy_pass http://mermaid:3000;
        proxy_http_version 1.1;
        proxy_set_header Host $host;
        proxy_set_header Connection '';
        proxy_buffering off;
        proxy_cache off;
        chunked_transfer_encoding off;
    }
}
